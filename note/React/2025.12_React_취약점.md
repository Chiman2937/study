# React2Shell 취약점 총정리

## 📅 2025년 11월 29일
### 최초 버그 신고
- **발견자**: 라클란 데이비슨 (Lachlan Davidson)
- **경위**: 리액트 사용 중 문제 발견 → 메타에 책임있는 공개(Responsible Disclosure)

---

## 🚨 2025년 12월 3일
### 메타 긴급 패치 발표

#### CVE-2025-55182 (CVSS 10.0 - Critical)
**무엇이 위험한가?**
- RSC(React Server Components)에서 **인증 없이** 원격 코드 실행(RCE) 가능
- 로그인 없이 서버를 완전히 장악할 수 있음

**가능한 공격**
- 🔓 비밀키, 자격 증명, 사용자 정보 탈취
- 🚪 백도어 설치로 지속적인 접근 권한 확보
- 💀 랜섬웨어로 데이터 암호화
- 💣 **서버에서 원하는 모든 것을 할 수 있음**

**점수의 의미**
- CVSS 점수: **10.0/10.0** (만점)
- 영화 평론가가 별 5개 주는 것과 같은 수준
- 2021년 Log4Shell 이후 최고 심각도
- "React2Shell"이라는 별칭으로 불림

---

## 💣 PoC 공개 및 실전 공격

### 라클란 데이비슨의 대응
- **React2Shell 웹사이트** 개설: https://react2shell.com
- **PoC(Proof of Concept)** 공개
  - 취약점이 실제로 위험함을 증명하는 코드
  - 가짜 PoC들이 난무해서 진짜를 공개함
  - ⚠️ 공격 코드와 거의 차이 없는 수준

### 실전 공격 발생
**공개 후 몇 시간 만에 공격 시작**
- 🇨🇳 중국 연계 해킹 조직들이 즉시 악용
  - Earth Lamia
  - Jackpot Panda
  - 기타 미확인 중국 국가 지원 그룹들
- Amazon, Google, Palo Alto Networks 등에서 실제 공격 탐지

---

## 🔍 취약점의 원리
```
사용자 컴퓨터 → 웹사이트 접속 → 서버에서 React 실행
```

### 어디가 위험한가?
❌ 사용자 컴퓨터 (안전함)  
✅ **서버** (위험함)

### 공격 흐름
```
1. 사용자 컴퓨터
   ↓ 악성 데이터 전송 (직렬화)
   
2. 서버 수신
   ↓ 데이터 역직렬화 (Deserialization)
   
3. 💥 여기서 폭발!
   → 서버에서 임의의 코드 실행
```

**핵심 문제점**
- RSC Flight 프로토콜이 받은 데이터를 제대로 검증하지 않음
- 악의적인 데이터 구조를 그대로 역직렬화
- 공격자가 서버 권한으로 JavaScript 코드 실행 가능

---

## 📋 2025년 12월 11일
### 추가 취약점 발견 및 패치

React2Shell 공개 후 보안 연구자들이 같은 코드 영역을 집중 분석하다가 추가 발견

#### 1️⃣ CVE-2025-55184 (CVSS 7.5 - High)
**서비스 거부 공격 (DoS)**
- 악의적 HTTP 요청으로 **무한 루프** 발생
- 서버 CPU를 계속 소모하며 멈춤
- 다른 사용자들의 요청을 처리하지 못함

#### 2️⃣ CVE-2025-55183 (CVSS 5.3 - Medium)
**소스 코드 노출**
- 특정 HTTP 요청으로 서버의 다른 함수 소스 코드 열람 가능
- 비즈니스 로직 유출
- 코드에 하드코딩된 비밀키/API 키 노출 위험

#### 3️⃣ CVE-2025-67779 (CVSS 7.5 - High)
**불완전한 패치**
- CVE-2025-55184의 첫 패치가 불완전함
- React 19.0.2, 19.1.3, 19.2.2 버전도 여전히 취약
- 같은 날 추가 패치 배포

**발견자들**
- Andrew MacPherson → CVE-2025-55183
- RyotaK (GMO Flatt Security), Shinsaku Nomura (Bitforest) → CVE-2025-55184
- React 팀 내부 → CVE-2025-67779

---

## ⚠️ 결론

### 영향 범위
- React 19.x 버전
- Next.js 15.x, 16.x (App Router 사용 시)
- React Server Components를 사용하는 모든 프레임워크

### 해결 방법
**단 하나: 즉시 업데이트**
- React: 19.0.3, 19.1.4, 19.2.3 이상
- Next.js: 최신 패치 버전

**업계의 딜레마**
- 업데이트 안 하면 → 해킹 위험
- 업데이트 잘못하면 → 서비스 장애
- 하지만 **업데이트가 유일한 해결책**

---

## 📊 역사적 비교

| 취약점 | 연도 | CVSS | 별칭 |
|--------|------|------|------|
| Log4Shell | 2021 | 10.0 | CVE-2021-44228 |
| React2Shell | 2025 | 10.0 | CVE-2025-55182 |

두 취약점 모두 업계를 뒤흔든 초대형 보안 사고로 기록됨
