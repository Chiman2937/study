# 📝 기능 구현 - Toast, Modal 개발
본격적으로 페이지의 기능을 구현하기 전에 팀원들 각자 공용컴포넌트를 먼저 개발하기로 정했고, 내가 담당했던 것은 Toast, Modal이 었기 때문에 바로 작업을 시작했다.

## 💡 초안
초기에 만든 Toast, Modal 컴포넌트는 단순했다.

그냥 하나의 공용컴포넌트로 제작하고, 부모 페이지 컴포넌트에서 제어해주는 식으로 구현하면 되겠지 하는 마음으로 일단 만들어 보았다.

```js
const Modal = () => {
  return ...
}

export default Modal;
```

```js
//부모 컴포넌트
import Modal from './Modal';
const PageComponent = () => {
  const [isModalOpen, setIsModalOpen] = useState(false);

  return (
    ...
    {isOpen && <Modal/>
  )
}
```

이렇게 만들어 놓으니 2가지 문제가 있었다.

1. 부모에서 Modal과 Toast를 사용하기 위해서 isModalOpen과 같은 state를 일일이 제어를 해줘야 함
2. 부모 컴포넌트의 return문에 Modal과 Toast를 위치 시켜야한다는 점

그러니까, 역할 분리가 제대로 이루어지지 않는다고 판단했다.

## 💡 개선
현재의 문제점을 개선하기 위해 어떤 방식을 적용할 지 고민을 해 보았다.
1. 모든 컴포넌트에서 showModal, showToast 등의 함수를 이용해 제어가 가능해야함
2. 역할 분리를 명확하게
   - Modal, Toast 에서는 디자인만
   - 부모컴포넌트에서는 Modal 호출만

그럼 여기서 Modal과 Toast를 열고 닫는 함수를 관리하며 z-index를 관리하는 등 종합적인 동작을 관리하는 컴포넌트가 필요하다고 생각했다.

### ❗ Context의 활용
이 문제들을 해결하기 위해 Context를 사용하는 방법을 선택했다.

#### ModalProvider.jsx
```js
export const ModalContext = createContext();

export const ModalProvider = () => {
  const [modal,setModal] = useState(null);
  const [isOpen,setIsOpen] = useState(false);
  const showModal = (ModalComponent) => {
    setIsOpen(true);
    setModal(ModalComponent);
  };
  const closeModal = () => { setIsOpen(false) };

  return (
    <ModalContext.Provider value={ showModal, closeModal }>
      {children}
      {isOpen &&
      createPortal(
        <div className='modal-background'>
          <div className='modal-wrapper'>
            {modal}
          </div>
        </div>
      ,document.getElementById('modal-root')}
    </ModalContext.Provider>
  )
}
```
#### useModal.jsx
```js
import { useContext } from 'react';
import { ModalContext } from '../contexts/ModalProvider';

export const useModal = () => {
  const context = useContext(ModalContext);
  if (!context) throw new Error('useModal은 ModalProvider 안에서 사용되어야 합니다');
  return context;
};
```

#### PageComponent.jsx
```js
import { useModal } from '@/hooks/useModal';
const PageComponent = () => {

  const { showModal, closeModal } = useModal();

  return (
    
  );
}
```

1. 모든 컴포넌트는 ModalProvider 하위에 위치하도록 한다.
2. ModalProvider에서 Modal의 Open/Close를 제어한다.
3. 실제 Modal을 사용하는 컴포넌트에서는 `showModal`, `closeModal` 함수를 호출하여 제어하도록 만든다.
4. 어떤 Modal을 사용할 지는 실제 사용하는 컴포넌트에서 자유롭게 선택할 수 있도록 만든다.
